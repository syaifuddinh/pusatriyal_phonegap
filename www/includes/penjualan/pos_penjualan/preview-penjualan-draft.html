<div class="subcontent" style="">
<style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
    }

    .title-edit
    {
        margin-top: 60px;
        margin-left: 20px;
        margin-bottom: 30px;
        width: 70%;
        border: none;
        color: #14c56d;
    }

    .btnSubmit
    {
        border-radius: 50mm;
        margin-top: 8mm;
        margin-bottom: 50px;
        padding: 3mm 10mm;
        border: none;
        cursor: pointer;
        background: #42ec98;
        color: #FFFFFF;
        font-weight: bold;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
    }
    .border-bottom-1 {
        border-bottom: 2px solid #42ec98 !important;
    }
    .label-for
    {
      font-weight: bold;
      color: #646464ff;
      margin-bottom: 0px;
    }
    .listx
    {
      font-weight: bold;
    }

    .card-body {
      border-bottom:1px solid #e7e7e7;
    }/*
    .card {
      margin-left: 4mm;
      margin-right: 4mm;
      margin-bottom: 10mm;
    }
    */
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
    }
    #login .container #login-row #login-column #login-box {
      margin-top: 60px;
      max-width: 600px;
      height: 320px;
    }
    #login .container #login-row #login-column #login-box #login-form {
      padding: 26px;
      margin-bottom: 35mm;
    }
    #login .container #login-row #login-column #login-box #login-form #register-link {
      margin-top: -85px;
    }


    .btnSubmit
    {
        border-radius: 50mm;
        margin-top: 8mm;
        margin-bottom: 50px;
        padding: 3mm 10mm;
        border: none;
        cursor: pointer;
        background: #42ec98;
        color: #FFFFFF;
        font-weight: bold;
        box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
    }
    .border-bottom-1 {
        border-bottom: 2px solid #42ec98 !important;
    }
    .label-for
    {
      font-weight: bold;
      color: #646464ff;
      margin-bottom: 0px;
    }
    form {
      padding-left: 5mm;
      padding-right: 5mm;
    }
</style>

<div class="pusatriyal-submit btn-group">

  <button class="btn btn-warning" pusatriyal-target="includes/penjualan/pos_penjualan/edit-penjualan.html" pusatriyal-role="routing" pusatriyal-callback="edit_penjualan_func" id="btn-edit" >
    <i class="fa fa-pencil"></i>
  </button>
  <button class="btn btn-danger" id="btn-hapus">
    <i class="fa fa-trash-o"></i>
  </button>
</div>
<div class="breadcrumb-pusatriyal">
  <span class="active">Preview Nota Penjualan <label class="badge badge-success">Draft</label></span>
</div>
<form id="opname-form" class="form" action="" method="post" autocomplete="off" style="margin-bottom: 25mm">
<input type="hidden" name="_token" id="_token">
<input type="hidden" name="s_id" id="s_id">
    <div class="w-100 text-center mb-3">
      <h3>Nota</h3>
      <h5 id="nota">
          ?
      </h5>
    </div>
    <div class="form-group">
        <label for="customer" class="label-for">Customer</label>
        <div class="border-bottom border-bottom-1">
        <input type="text" class="form-control" name="customer" id="customer" readonly value="">
      </div>
    </div>
    <div class="form-group">
        <label class="label-for" for="address" >Alamat</label><br>
        <div class="border-bottom border-bottom-1">
          <input type="text" class="form-control" readonly="" id="address" name="address">
        </div>
    </div>
    <div class="form-group">
        <label for="cara_pembayaran" class="label-for">Cara Pembayaran</label><br>
        <div class="border-bottom border-bottom-1">
        <input type="text" class="form-control" name="cara_pembayaran" id="cara_pembayaran" readonly value="">
        </div>
    </div>
    <div class="form-group input-daterange">
      <label for="cara_pembayaran" class="label-for">Tanggal Faktur</label><br>
      <div class="border-bottom border-bottom-1">
      <input type="text" class="form-control" value="" id="tanggal_faktur" readonly name="tanggalfaktur" readonly="">
      </div>
    </div>
    <div class="form-group input-daterange" id="divjatuhtempo" style="display:none;">
      <label for="jatuh_tempo" class="label-for">Jatuh Tempo</label><br>
      <div class="border-bottom border-bottom-1">
      <input type="text" class="form-control" value="" id="jatuh_tempo" name="jatuh_tempo" readonly="">
      </div>
    </div>
    <div id="form-list-item">

    </div>
<rawcontent class="datalist">
  <div class="accordion">
    <div class="card">
      <div class="card-header bg-success header-collapse p-0" id="headingOne">
        <h5 class="mb-0">
          <button class="btn btn-link btn-block btn-header text-white" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            BRG/0001 - 10 Riyal
          </button>
        </h5>
      </div>

      <div id="collapseOne" class="collapse datalist-collapse" aria-labelledby="headingOne" data-parent="#list-item">
        <div class="card">
          <div class="card-body card-forlist p-3">

            <span>
              <small class="font-weight-bold">Qty Sistem</small> <small id="qty_sistem">10</small>
            </span>
            <br>
            <span>
              <small class="font-weight-bold">Qty Real</small> <small id="qty_real">10</small>
            </span>
          </div>
          <div class="card-footer">
            <span>
              <span class="font-weight-bold">Status</span> <span id="status">Hilang</span>
            </span>
          </div>

        </div>
      </div>
    </div>
  </div>
</rawcontent>


</form>

    <script type="text/javascript" src="includes/penjualan/pos_penjualan/js/preview-penjualan-draft-commander.js"></script>
    <script type="text/javascript">
    $('#btn-hapus').click(function(){
      iziToast.question({
        timeout:false,
          close: false,
          overlayClose:true,
          overlay: true,
          displayMode: 'once',
          id: 'question',
          zindex: 999,
          title: 'Konfirmasi!',
          message: 'Apa anda yakin mau menghapus data ini?',
          position: 'center',
          buttons: [
              ['<button class="w-100 mt-3"><b>YES</b></button>', function (instance, toast) {
            $.ajax({
              url:url('api/produk/penjualan/pos_penjualan/hapus'),
              data:{id:$('#s_id').val()},
              type:'get',
              success:function(res){
                if (res.status === "berhasil") {
                  iziToast.success({
                    title:'Sukses!',
                    message:'Data berhasil dihapus!'
                  });
                Routing.load_page('includes/penjualan/pos_penjualan/index-penjualan.html');
                } else if(res.status === 'gagal'){
                  iziToast.error({
                    title:'Gagal!',
                    message:'Data gagal dihapus!'
                  });
                }
              },
              error: function(jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect.\n Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found. [404]');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error [500].');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error.\n' + jqXHR.responseText);
                }
              }
            });
                  instance.hide({ transitionOut: 'fadeOut' }, toast, 'button');

              }, true],
              ['<button class="w-100 mt-3">NO</button>', function (instance, toast) {

                  instance.hide({ transitionOut: 'fadeOut' }, toast, 'button');

              }],
          ]
      });
    });

    function edit_penjualan_func(){
      $('#jumlahdt').val(jumlahdt);
      $('#nota').text(unit.data.s_code);
      $('#s_id').val(unit.data.s_id);
      $('#address').val(unit.data.c_address);
      $('#cara_pembayaran').val(unit.data.s_jenis_bayar.toUpperCase());
      if (unit.data.s_jenis_bayar != 'tunai') {
        $('#divjatuhtempo').css('display', '');
        $('#jatuh_tempo').val(moment(unit.data.s_duedate).format('DD-MM-YYYY'));
      }
      $('#tanggal_faktur').val(moment(unit.data.s_date).format('DD-MM-YYYY'));

      var html = "";
      for (var i = 0; i < unit.datadt.length; i++) {
        if (unit.kemplo[i].i_buy == 'Y') {
          var readonly = '';
        } else if (unit.kemplo[i].i_buy == 'N') {
          var readonly = 'readonly';
        }

        html += '<div class="accordion">'+
              '<div class="card">'+
                '<div class="card-header bg-success header-collapse p-0" id="header-'+ i +'">'+
                  '<h5 class="mb-0">'+
                    '<button class="btn btn-link btn-block btn-header text-white collapsed" type="button" data-toggle="collapse" data-target="#collapse-'+ i +'" aria-expanded="true" aria-controls="collapse-'+ i +'">'+
                      unit.datadt[i].i_code + ' - ' + unit.datadt[i].i_name +
                      '<input type="hidden" name="iditem[]" id="iditem'+unit.datadt[i].i_id+'" value="'+unit.datadt[i].i_id+'" '+readonly+'>'+
                    '</button>'+
                  '</h5>'+
                '</div>'+
                ''+
                '<div id="collapse-'+ i +'" class="collapse datalist-collapse" aria-labelledby="header-'+ i +'" data-parent="#form-list-item">'+
                  '<div class="card">'+
                    '<div class="card-body card-forlist p-3">'+
                    ''+
                      '<table class="w-100 table-accordion">'+
                        '<tr>'+
                          '<th>Qty</th>'+
                          '<td>'+
                            '<div class="input-group">'+
                              '<input type="text" readonly onkeyup="qtyinput('+unit.datadt[i].i_id+')" id="qtyinput'+unit.datadt[i].i_id+'" class="form-control lib_qty_list" name="qty[]" value="'+ unit.datadt[i].sd_qty +'">'+
                            '</div>'+
                          '</td>'+
                        '</tr>'+
                        '<tr>'+
                          '<th>Satuan</th>'+
                          '<td><input type="text" readonly="" class="form-control" name="satuan[]" value="'+ unit.datadt[i].u_unit +'"></td>'+
                        '</tr>'+
                        '<tr>'+
                          '<th>Harga</th>'+
                          '<td>'+
                            '<div class="input-group">'+
                              '<input type="text" '+readonly+' class="form-control lib_harga_list" onkeyup="hargainput('+unit.datadt[i].i_id+')" id="hargainput'+unit.datadt[i].i_id+'" onkeyup="hargainput('+unit.datadt[i].i_id+')" name="harga[]" value="'+ get_currency(parseInt(unit.datadt[i].sd_price)) +'"">'+
                            '</div>'+
                          '</td>'+
                        '</tr>'+
                        '<tr>'+
                          '<th>Disc Percent</th>'+
                          '<td>'+
                            '<div class="input-group">'+
                              '<input type="number" onkeyup="discpercent('+unit.datadt[i].i_id+')" class="form-control disc_percent" id="discpercent'+unit.datadt[i].i_id+'" name="disc_percent[]" value="">'+
                              '<input type="hidden" class="form-control" id="sd_disc_percent_value'+unit.datadt[i].i_id+'" name="sd_disc_percent_value[]">'+
                            '</div>'+
                          '</td>'+
                        '</tr>'+
                        '<tr>'+
                          '<th>Disc Value</th>'+
                          '<td>'+
                            '<div class="input-group">'+
                              '<input type="number" onkeyup="discvalue('+unit.datadt[i].i_id+')" id="discvalue'+unit.datadt[i].i_id+'" class="form-control disc_value" name="disc_value[]" value="">'+
                            '</div>'+
                          '</td>'+
                        '</tr>'+
                        '<tr>'+
                          '<th>Total</th>'+
                          '<td>'+
                            '<div class="input-group">'+
                              '<input type="text" readonly class="form-control total" id="totalinput'+unit.datadt[i].i_id+'" name="total[]" value="'+ get_currency(parseInt(unit.datadt[i].sd_total)) +'">'+
                            '</div>'+
                          '</td>'+
                        '</tr>'+
                      '</table>'+
                      ''+
                    '</div>'+
                    '<div class="card-footer">'+
                      '<button class="btn btn-danger btn-sm btn-hapus pull-right btn-hapus-accordion" type="button"><i class="fa fa-trash-o"></i> Hapus</button>'+
                    '</div>'+
                    ''+
                  '</div>'+
                '</div>'+
              '</div>'+
          '</div>';
      }
      $('#form-list-item').html(html);
    }
    </script>
</div>
